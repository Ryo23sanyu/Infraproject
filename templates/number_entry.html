{% extends 'base.html' %}

{% block content %}
<title>登録フォーム</title>
<style>
body {
    font-family: Arial, sans-serif;
    margin: 20px;
}
.form-section {
    margin-bottom: 20px;
}
.form-section label {
    display: block;
    margin-bottom: 5px;
}
.form-section input, .form-section select {
    width: 150px;
    padding: 5px;
    margin-bottom: 10px;
}
.form-section {
    display: flex;
    align-items: center;
    gap: 10px;
}
.inline-group {
    display: flex;
    align-items: center;
    gap: 15px; /* フレックスアイテム間の空間 */
    margin-bottom: 10px;
}
.form-section .inline-group label {
    margin: 0;
}
.form-section .inline-group input, .form-section .inline-group select {
    margin: 0 10px;
}

button.toggle-button {
    margin: 0 5px;
    padding: 5px 10px;
    cursor: pointer;
    background-color: #ddd;
    border: none;
    border-radius: 5px;
}
button.toggle-button.selected {
    background-color: #007bff;
    color: white;
}

.entries .entry {
    display: inline-block;
    margin-right: 10px;
    white-space: nowrap;
    gap: 10px; /* エントリ間の間隔を整える */
}

button {
    margin-top: 5px;
    padding: 5px 10px;
    cursor: pointer;
}
</style>

<h1>登録フォーム</h1>

<div class="form-section">
    <div class="inline-group">
        <label for="part-name">部材名:</label>
        <select id="part-name">
            <option value="部材名1">主桁</option>
            <option value="部材名2">横桁</option>
            <option value="部材名3">床版</option>
        </select>
    </div>

    <div class="inline-group">
        <label for="material">材料:</label>
        <div id="material-buttons" class="toggle-buttons">
            <button type="button" class="toggle-button" data-value="鋼">鋼</button>
            <button type="button" class="toggle-button" data-value="コンクリート">コンクリート</button>
            <button type="button" class="toggle-button" data-value="その他">その他</button>
        </div>
    </div>

    <div class="inline-group">
        <label for="main_frame">主要部材:</label>
        <div id="main-frame-buttons" class="toggle-buttons">
            <button type="button" class="toggle-button" data-value="〇">〇</button>
            <button type="button" class="toggle-button" data-value="✕">✕</button>
        </div>
    </div>
</div>

<div class="form-section">
    <label>連続した番号:</label>
    <button type="button" onclick="addSerialEntry()">追加</button>
    <div id="serial-entries" class="entries">
        <div class="entry">
            <br>
            <input type="number" placeholder="番号1" min="1000"> ～ <input type="number" placeholder="番号2" min="1000">
        </div>
    </div>
</div>

<div class="form-section">
    <label>単一の番号:</label>
    <button type="button" onclick="addSingleEntry()">追加</button>
    <div id="single-entries" class="entries">
        <div class="entry">
            <br>
            <input type="number" placeholder="番号" min="1000">
        </div>
    </div>
</div>

<div class="form-section">
    <button type="button" onclick="register()">登録</button>
</div>

<script>

    // 材料ボタンの選択切り替え
    const materialButtons = document.querySelectorAll('#material-buttons .toggle-button');
    materialButtons.forEach(button => {
        button.addEventListener('click', () => {
            button.classList.toggle('selected');
        });
    });

    // 主要部材ボタンの選択切り替え
    const mainFrameButtons = document.querySelectorAll('#main-frame-buttons .toggle-button');
    mainFrameButtons.forEach(button => {
        button.addEventListener('click', () => {
            mainFrameButtons.forEach(btn => btn.classList.remove('selected'));
            button.classList.add('selected');
        });
    });

    function addSerialEntry() {
        const container = document.getElementById('serial-entries');
        const entryDiv = document.createElement('div');
        entryDiv.classList.add('entry');
        entryDiv.innerHTML = `<input type="number" placeholder="番号1" min="1000"> ～ <input type="number" placeholder="番号2" min="1000">`;
        container.appendChild(entryDiv);
    }

    function addSingleEntry() {
        const container = document.getElementById('single-entries');
        const entryDiv = document.createElement('div');
        entryDiv.classList.add('entry');
        entryDiv.innerHTML = `<input type="number" placeholder="番号" min="1000">`;
        container.appendChild(entryDiv);
    }

    function register() {
        const partName = document.getElementById('part-name').value;
        const serialEntries = Array.from(document.querySelectorAll('#serial-entries .entry'));
        const singleEntries = Array.from(document.querySelectorAll('#single-entries .entry'));

        const serialNumbers = serialEntries.map(entry => {
            const inputs = entry.getElementsByTagName('input');
            return {from: inputs[0].value, to: inputs[1].value};
        });

        const singleNumbers = singleEntries.map(entry => entry.getElementsByTagName('input')[0].value);

        console.log("パーツ名:", partName);
        console.log("連続した番号:", serialNumbers);
        console.log("単一の番号:", singleNumbers);

        // 登録処理をここに追加 (例: サーバーにデータを送信)
    }
</script>
{% endblock %}