{% extends 'base.html' %}

{% block content %}
  <h2>ファイルアップロード</h2>
  <form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    <div id="dropArea" style="border: 2px dashed gray; padding: 100px;">
      ファイルをドラッグ＆ドロップまたはクリックしてアップロードしてください。
    </div>
    {{ form.as_p }}
    <button type="submit">アップロード</button>
  </form>

  <script>
    const dropArea = document.getElementById('dropArea');
    
    dropArea.addEventListener('dragover', (event) => {
      event.preventDefault();
      dropArea.style.border = '2px dashed blue';
    });
  
    dropArea.addEventListener('dragleave', () => {
      dropArea.style.border = '2px dashed gray';
    });
  
    dropArea.addEventListener('drop', (event) => {
      event.preventDefault();
      dropArea.style.border = '2px dashed gray';
      const files = event.dataTransfer.files;
      console.log(files); // 選択されたファイルの情報を取得できます
      
      // ファイルを格納する処理
      const formData = new FormData(); // フォームデータを作成
      formData.append('file', files[0]); // ファイルを追加
      
      // AJAXリクエストを使ってファイルをアップロード
      fileArea.addEventListener('drop', function(evt){
        evt.preventDefault();
        fileArea.classList.remove('dragenter');
        var files = evt.dataTransfer.files;
        console.log("DRAG & DROP");
        console.table(files);
        fileInput.files = files;
        photoPreview('onChenge',files[0]);  
    });
  </script>
  
{% endblock %}